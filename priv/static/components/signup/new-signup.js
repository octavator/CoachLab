import FirstStep from"./first-step.js";import CoachSecondStep from"./coach/second-step.js";import DefaultSecondStep from"./default/second-step.js";import CoachThirdStep from"./coach/third-step.js";import DefaultThirdStep from"./default/third-step.js";import Navbar from"../../navbar.js";import Flash from"../../flash.js";class SignUp extends React.Component{constructor(props){super(props);const urlParams=new URLSearchParams(document.location.search);const role=urlParams.get("role");const coach_id=urlParams.get("coach");let form=role&&coach_id?{role:role,coaches:[coach_id]}:{coaches:[]};let step=role?2:1;this.state={form:form,steps:[1,2,3],step:step,flashMessage:"",flashType:"",showFlash:false}}sendForm(){http.post("/sign-up",this.state.form).then(res=>{if(res.status==200)return window.location.href="/bienvenue";this.showFlashMessage("error","Une erreur inattendue est survenue.")}).catch(err=>this.showFlashMessage("error",err?.response?.data||"Une erreur inattendue est survenue."))}setStateForm(new_form,is_complete=false){if(!is_complete)return this.setState({form:{...this.state.form,...new_form}});this.setState({form:{...this.state.form,...new_form}},this.sendForm)}showFlashMessage(type,message){this.setState({showFlash:true,flashMessage:message,flashType:type},()=>setTimeout(()=>this.setState({showFlash:false}),5000))}render(){return/*#__PURE__*/React.createElement("div",{className:"clab-container"},/*#__PURE__*/React.createElement(Navbar,{blue_bg:this.state.step==1?false:true,user:{}}),/*#__PURE__*/React.createElement(Flash,{showFlash:this.state.showFlash,flashType:this.state.flashType,flashMessage:this.state.flashMessage}),this.state.step==1?/*#__PURE__*/React.createElement(FirstStep,{showFlashMessage:this.showFlashMessage,update_form:data=>this.setStateForm(data),change_step:new_step=>this.setState({step:new_step})}):this.state.form.role=="coach"?this.state.step==2?/*#__PURE__*/React.createElement(CoachSecondStep,{user_form:this.state.form,showFlashMessage:(type,msg)=>this.showFlashMessage(type,msg),update_form:(data,is_complete)=>this.setStateForm(data,is_complete),change_step:new_step=>this.setState({step:new_step})}):/*#__PURE__*/React.createElement(CoachThirdStep,{user_form:this.state.form,showFlashMessage:(type,msg)=>this.showFlashMessage(type,msg),send_form:this.sendForm,update_form:(data,is_complete)=>this.setStateForm(data,is_complete),change_step:new_step=>this.setState({step:new_step})}):this.state.step==2?/*#__PURE__*/React.createElement(DefaultSecondStep,{user_form:this.state.form,showFlashMessage:(type,msg)=>this.showFlashMessage(type,msg),update_form:(data,is_complete=false)=>this.setStateForm(data,is_complete),change_step:new_step=>this.setState({step:new_step})}):/*#__PURE__*/React.createElement(DefaultThirdStep,{user_form:this.state.form,showFlashMessage:(type,msg)=>this.showFlashMessage(type,msg),send_form:this.sendForm,update_form:(data,is_complete)=>this.setStateForm(data,is_complete),change_step:new_step=>this.setState({step:new_step})}))}}const domContainer=document.querySelector(".signup-wrapper");ReactDOM.render(/*#__PURE__*/React.createElement(SignUp,null),domContainer);