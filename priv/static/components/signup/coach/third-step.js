import{TextInput,FileInput,TextArea,Button}from"../../forms/inputs.js";import Stepper from"../stepper.js";class DefaultThirdStep extends React.Component{constructor(props){super(props);this.state={form:{specialties:[]},filenames:{}}}uploadFile(key,e){const formData=new FormData;let new_filenames={...this.state.filenames};let new_form={...this.state.form};const filename=`${key}_${this.props.user_form.lastname}_${e.name}`.replace(" ","-").replace("/","");new_filenames[key]=filename;formData.append("myFile",e,filename);new_form[key]=filename;fetch("/inscription/file",{body:formData,method:"POST"}).then(res=>{if(res.status==200)this.setState({filenames:new_filenames,form:new_form});else this.props.showFlashMessage("error","Une erreur est survenue lors de l'envoi de votre fichier.")}).catch(e=>{this.props.showFlashMessage("error","Une erreur est survenue lors du t\xE9l\xE9chargement")})}updateSpecialty(value,index){let new_specialties=this.state.form.specialties;new_specialties[index]=value;this.setState({form:{...this.state.form,specialties:new_specialties}})}validate(){let required_keys=[];let isValid=required_keys.every(key=>{return this.state.form[key]!=undefined})&&this.state.form.specialties.length>0;if(!isValid)this.props.showFlashMessage("error","Veuillez renseigner tous les champs");return isValid}sendForm(){if(this.validate()){this.props.update_form(this.state.form,true)}}render(){return/*#__PURE__*/React.createElement("div",{className:"step-wrapper"},/*#__PURE__*/React.createElement("div",{className:"first-step-wrapper"},/*#__PURE__*/React.createElement("form",{className:"step-form",onSubmit:e=>{e.preventDefault()}},/*#__PURE__*/React.createElement("div",{className:"step-sections-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-wrapper "},/*#__PURE__*/React.createElement("div",{className:"step-section-label text-2"},"Quelles sont vos sp\xE9cialit\xE9s ?"),/*#__PURE__*/React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:true,value:this.state.form.specialties[0],onChange:e=>{this.updateSpecialty(e,0)},name:"specialties_0",placeholder:""}),/*#__PURE__*/React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:false,value:this.state.form.specialties[1],onChange:e=>{this.updateSpecialty(e,1)},name:"specialties_1",placeholder:""}),/*#__PURE__*/React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:false,value:this.state.form.specialties[2],onChange:e=>{this.updateSpecialty(e,2)},name:"specialties_2",placeholder:""}),/*#__PURE__*/React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:false,value:this.state.form.specialties[3],onChange:e=>{this.updateSpecialty(e,3)},name:"specialties_3",placeholder:""})),/*#__PURE__*/React.createElement("div",{className:"step-section-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-label text-2"},"Merci de t\xE9l\xE9charger votre dipl\xF4me,",/*#__PURE__*/React.createElement("br",null)," certification et/ou tout document",/*#__PURE__*/React.createElement("br",null)," attestant de votre autorisation",/*#__PURE__*/React.createElement("br",null)," \xE0 pratiquer"),/*#__PURE__*/React.createElement(FileInput,{accept:".png,.jpeg,.jpg,.pdf",text:"Parcourir...",filename:this.state.filenames["certification"]&&this.state.filenames.certification.split("_").pop(),onChange:e=>this.uploadFile("certification",e),extraClass:"bg-white  text-3"})),/*#__PURE__*/React.createElement("div",{className:"step-section-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-label  text-2"},"Merci de t\xE9l\xE9charger une photo professionnelle"),/*#__PURE__*/React.createElement(FileInput,{accept:".png,.jpeg,.jpg,.pdf",text:"Parcourir...",filename:this.state.filenames["avatar"]&&this.state.filenames.avatar.split("_").pop(),onChange:e=>this.uploadFile("avatar",e),extraClass:"bg-white  text-3"}))),/*#__PURE__*/React.createElement("div",{className:"step-sections-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-label  text-2"},"Pr\xE9sentez-vous bri\xE8vement ",/*#__PURE__*/React.createElement("span",{className:""},"(100 caract\xE8res maximum)")),/*#__PURE__*/React.createElement(TextArea,{value:this.state.form.desc,maxlength:100,onChange:value=>{this.setState({form:{...this.state.form,desc:value}})}})),/*#__PURE__*/React.createElement("div",{className:"step-section-wrapper"},/*#__PURE__*/React.createElement("div",{className:"step-section-label  text-2"},"Merci de t\xE9l\xE9charger une copie de votre RIB"),/*#__PURE__*/React.createElement(FileInput,{accept:".png,.jpeg,.jpg,.pdf",text:"Parcourir...",filename:this.state.filenames["rib"]&&this.state.filenames.rib.split("_").pop(),onChange:e=>this.uploadFile("rib",e),extraClass:"bg-white  text-3"}))),/*#__PURE__*/React.createElement(Button,{extraClass:"cl-button cl-form-button bg-white  text-3 hidden",onClick:()=>{this.sendForm()},text:"Suivant"})),/*#__PURE__*/React.createElement(Button,{extraClass:"cl-button cl-form-button bg-white  text-3",onClick:()=>{this.sendForm()},text:"Suivant"})),/*#__PURE__*/React.createElement(Stepper,{step:"3"}))}}export default DefaultThirdStep;