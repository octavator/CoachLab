var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}import Stepper from"../stepper.js";import{TextInput,FileInput,Button}from"../../forms/inputs.js";var CoachSecondStep=function(_React$Component){_inherits(CoachSecondStep,_React$Component);function CoachSecondStep(props){_classCallCheck(this,CoachSecondStep);var _this=_possibleConstructorReturn(this,(CoachSecondStep.__proto__||Object.getPrototypeOf(CoachSecondStep)).call(this,props));_this.state={form:{},filename:""};return _this}_createClass(CoachSecondStep,[{key:"validate",value:function validate(){var _this2=this;var required_keys=["idcard"];var isValid=required_keys.every(function(key){return _this2.state.form[key]!=undefined});if(!isValid)this.props.showFlashMessage("error","Veuillez t\xE9l\xE9charger votre cart\xE9 d'identit\xE9");return isValid}},{key:"sendForm",value:function sendForm(){if(this.validate()){this.props.update_form(this.state.form);this.props.change_step(3)}}},{key:"uploadFile",value:function uploadFile(e){var _this3=this;console.log(e);console.log(e.name);var formData=new FormData;var filename=("idcard_"+this.state.form.lastname+"_"+e.name).replace(" ","-");formData.append("myFile",e,filename);http.post("/inscription/file",formData).then(function(res){_this3.setState({filename:filename,form:Object.assign({},_this3.state.form,{idcard:filename})})})}},{key:"render",value:function render(){var _this4=this;return React.createElement("div",{className:"step-wrapper"},React.createElement("div",{className:"first-step-wrapper"},React.createElement("form",{className:"step-form",onSubmit:function onSubmit(e){e.preventDefault()}},React.createElement("div",{className:"step-sections-wrapper"},React.createElement(TextInput,{type:"email",extraClass:"cl-form-input text-3",required:true,value:this.state.form.email,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{email:e})})},name:"email",placeholder:"Email"}),React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:true,value:this.state.form.firstname,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{firstname:e})})},name:"firstname",placeholder:"Pr\xE9nom"}),React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:true,value:this.state.form.lastname,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{lastname:e})})},name:"lastname",placeholder:"Nom"}),React.createElement(TextInput,{type:"password",extraClass:"cl-form-input  text-3",required:true,value:this.state.form.password,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{password:e})})},name:"password",placeholder:"Mot de passe"}),React.createElement(TextInput,{type:"password",extraClass:"cl-form-input  text-3",required:true,value:this.state.form.password_check,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{password_check:e})})},name:"password_check",placeholder:"Confirmez le mot de passe"}),React.createElement(TextInput,{extraClass:"cl-form-input  text-3",required:true,value:this.state.form.phone,onChange:function onChange(e){_this4.setState({form:Object.assign({},_this4.state.form,{phone:e})})},placeholder:"T\xE9l\xE9phone",name:"phone"}),React.createElement(FileInput,{accept:".png,.jpeg,.jpg",text:"Parcourir...",filename:this.state.filename&&this.state.filename.split("_").pop(),onChange:function onChange(e){return _this4.uploadFile(e)},extraClass:"bg-white  text-2",label:"Merci de t\xE9l\xE9charger une copie de votre pi\xE8ce d'identit\xE9"}),React.createElement(Button,{onClick:function onClick(){_this4.sendForm()},extraClass:"cl-button cl-form-button text-3 bg-white",text:"Suivant"})))),React.createElement(Stepper,{step:"2"}))}}]);return CoachSecondStep}(React.Component);export default CoachSecondStep;