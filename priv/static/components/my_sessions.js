var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}import Navbar from'./navbar.js';import Modal from'./modal.js';import Flash from'./flash.js';var MySessions=function(_React$Component){_inherits(MySessions,_React$Component);function MySessions(props){_classCallCheck(this,MySessions);var _this=_possibleConstructorReturn(this,(MySessions.__proto__||Object.getPrototypeOf(MySessions)).call(this,props));_this.state={user:{firstname:'',lastname:'',role:'default'},showFlash:false,flashType:'',flashMessage:'',search_input:'',reservations:[],agenda:{},appointment_detailed:{},appointment_details_modal:false};return _this}_createClass(MySessions,[{key:'componentDidMount',value:function componentDidMount(){var _this2=this;http.get('/api/me/agenda').then(function(res){_this2.setState({user:res.data.user,agenda:res.data.agenda},function(){var ids=Object.values(_this2.state.agenda);ids.forEach(function(id){http.get('/api/reservation/'+encodeURIComponent(id)).then(function(res){_this2.setState({reservations:[].concat(_toConsumableArray(_this2.state.reservations),[res.data])})})})})}).catch(function(err){_this2.showFlashMessage('error',err.response.data||'Une erreur inattendue est survenue.')})}},{key:'showFlashMessage',value:function showFlashMessage(type,message){var _this3=this;this.setState({showFlash:true,flashMessage:message,flashType:type},function(){setTimeout(function(){return _this3.setState({showFlash:false})},5000)})}},{key:'buildVideoId',value:function buildVideoId(){return!this.state.appointment_detailed.id?undefined:'/video?roomId='+encodeURIComponent(this.state.appointment_detailed.id+'+'+this.state.appointment_detailed.coach_id)}},{key:'render',value:function render(){var _this4=this;console.log(this.state.agenda);var detailsForm=[React.createElement('div',{key:'sessionTitle'},React.createElement('div',{className:'bold mt-1'},'Nom de la s\xE9ance:'),React.createElement('div',null,this.state.appointment_detailed.sessionTitle)),React.createElement('div',{key:'duration'},React.createElement('div',{className:'bold mt-1'},'Dur\xE9e:'),React.createElement('div',null,this.state.appointment_detailed.duration+' min')),React.createElement('div',{key:'isVideo'},React.createElement('div',{className:'bold mt-1'},'Visio-conf\xE9rence:'),React.createElement('div',null,this.state.appointment_detailed.isVideo?'Oui':'Non')),React.createElement('div',{key:'isMulti'},React.createElement('div',{className:'bold mt-1'},'S\xE9ance de groupe:'),React.createElement('div',null,this.state.appointment_detailed.isMulti?'Oui':'Non')),React.createElement('div',{key:'visioLink',className:'details-visioLink-section '+(this.state.appointment_detailed.isVideo&&this.buildVideoId()?'':' hidden')},React.createElement('div',{className:'bold mt-1'},'Lien de la visio-conf\xE9rence:'),React.createElement('div',{className:'clab-link',onClick:function onClick(){return window.open(''+_this4.buildVideoId(),'_blank')}},'Cliquez ici pour rejoindre'))];return React.createElement('div',null,React.createElement(Navbar,{blue_bg:true,user:this.state.user}),React.createElement(Modal,{toggle:this.state.appointment_details_modal,closeFunc:function closeFunc(){return _this4.setState({appointment_details_modal:false})},fields:detailsForm,title:'Votre RDV',id:'appointment-details'}),React.createElement(Flash,{showFlash:this.state.showFlash,flashType:this.state.flashType,flashMessage:this.state.flashMessage}),React.createElement('div',{className:'session-list'},React.createElement('h1',{className:'page-title text-1'},'Vos sessions'),React.createElement('div',{className:'session-list-wrapper'},this.state.reservations.map(function(resa,idx){console.log(resa);return React.createElement('div',{key:idx,onClick:function onClick(){return _this4.setState({appointment_details_modal:true,appointment_detailed:resa})},className:'session-list-row'},React.createElement('div',{className:'session-list-avatar'},React.createElement('img',{className:'round-avatar',onError:function onError(_ref){var currentTarget=_ref.currentTarget;currentTarget.onerror=null;// prevents looping
currentTarget.src='priv/static/images/avatar_placeholder.png'},src:'priv/static/images/avatar_placeholder.png'})),React.createElement('div',{className:'session-list-name text-2'},(resa.name||'Session coaching')+' avec '+resa.coach_name))})// src={`priv/static/images/${session.coach_id}/avatar.${this.getImageExt(session.avatar)}`}/>
)))}}]);return MySessions}(React.Component);var domContainer=document.querySelector('.page-wrapper');ReactDOM.render(React.createElement(MySessions,null),domContainer);