import Modal from"../modal.js";import{TextInput,Button}from"../forms/inputs.js";class ShowResaModal extends React.Component{constructor(props){super(props);this.state={sessionTitle:this.props.appointment_detailed?.sessionTitle||"",appointment_detailed:{}}}componentDidUpdate(prevProps){if(prevProps.appointment_detailed!==this.props.appointment_detailed){this.setState({sessionTitle:this.props.appointment_detailed?.sessionTitle})}}buildVideoId(){return!this.props.appointment_detailed.id?undefined:`/video?roomId=${encodeURIComponent(this.props.appointment_detailed.id)}`}updateResa(){http.post("/update-resa",{id:this.props.appointment_detailed.id,sessionTitle:this.state.sessionTitle}).then(res=>{if(res.status!=200)return this.props.showFlashMessage("error","Une erreur inconnue est survenue.");this.props.updateResa({...this.props.appointment_detailed,sessionTitle:this.state.sessionTitle});this.props.showFlashMessage("success","Votre rendez-vous a bien \xE9t\xE9 enregistr\xE9.")}).catch(err=>{this.props.showFlashMessage("error",err?.response?.data||"Une erreur inattendue est survenue.")})}render(){let fields=[/*#__PURE__*/React.createElement("div",{key:"sessionTitle"},/*#__PURE__*/React.createElement(TextInput,{value:this.state.sessionTitle,onChange:e=>{this.setState({sessionTitle:e})},label:"Nom de la s\xE9ance:",bold_label:"true",disabled:this.props.appointment_detailed.coach_id!=this.props.user.id,extraClass:" white-bg",Placeholder:"Th\xE8me de la session"}),","),/*#__PURE__*/React.createElement("div",{key:"duration"},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"Dur\xE9e:"),/*#__PURE__*/React.createElement("div",null,this.props.appointment_detailed.duration+" min")),/*#__PURE__*/React.createElement("div",{key:"isVideo"},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"Visio-conf\xE9rence:"),/*#__PURE__*/React.createElement("div",null,this.props.appointment_detailed.isVideo?"Oui":"Non")),/*#__PURE__*/React.createElement("div",{className:this.props.appointment_detailed.isVideo?"hidden":"",key:"adresse"},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"Lieu:"),/*#__PURE__*/React.createElement("div",null,this.props.appointment_detailed.address)),/*#__PURE__*/React.createElement("div",{key:"isMulti"},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"S\xE9ance de groupe:"),/*#__PURE__*/React.createElement("div",null,this.props.appointment_detailed.isMulti?"Oui":"Non")),/*#__PURE__*/React.createElement("div",{key:"visioLink",className:`details-visioLink-section ${this.props.appointment_detailed.isVideo&&this.buildVideoId()?"":" hidden"}`},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"Lien de la visio-conf\xE9rence:"),/*#__PURE__*/React.createElement("div",{className:"clab-link",onClick:()=>window.open(`${this.buildVideoId()}`,"_blank")},"Cliquez ici pour rejoindre")),/*#__PURE__*/React.createElement("div",{key:"payment",className:`details-payment-section ${this.props.appointment_detailed.paid?.includes(this.props.user.id)||this.props.appointment_detailed.coach_id==this.props.user.id?" hidden":""}`},/*#__PURE__*/React.createElement("div",{className:"bold mt-1"},"Lien de paiement de la session:"),/*#__PURE__*/React.createElement("div",{className:"clab-link",onClick:()=>window.open(`${this.props.payment_link}`,"_blank")},"Cliquez ici pour payer")),/*#__PURE__*/React.createElement("div",{className:"input-group"},/*#__PURE__*/React.createElement(Button,{extraClass:"cl-button mt-2",onClick:()=>{this.updateResa()},text:"Valider"}))];return/*#__PURE__*/React.createElement(Modal,{toggle:this.props.toggle,closeFunc:()=>this.props.closeFunc(),fields:fields,title:"Votre RDV",id:"appointment-details"})}}export default ShowResaModal;