import Navbar from"./navbar.js";import Flash from"./flash.js";//@TODO: use Stribe webhooks with signatures instead of API call w/ query params (unsecured)
class PaymentSuccess extends React.Component{constructor(props){super(props);this.state={user:{firstname:"",lastname:"",role:"default"},showFlash:false,flashType:"",flashMessage:"",reservation:{}}}componentDidMount(){window.location.href="/mes_sessions";//Unused for now
const urlParams=new URLSearchParams(document.location.search);const resa_id=urlParams.get("id");http.get("/api/me").then(userData=>{this.setState({user:userData.data},()=>{http.get(`/api/reservation/${encodeURIComponent(resa_id)}`).then(res=>{this.setState({reservation:res.data})})})}).catch(err=>{this.showFlashMessage("error",err?.response?.data||"Une erreur inattendue est survenue.")})}showFlashMessage(type,message){this.setState({showFlash:true,flashMessage:message,flashType:type},()=>{setTimeout(()=>this.setState({showFlash:false}),5000)})}render(){let date=this.state.reservation.id&&this.state.reservation.id.split(" ")[0]||"";let time=this.state.reservation.id&&this.state.reservation.id.split(" ")[1].split("+")[0]||"";return/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement(Navbar,{blue_bg:true,user:this.state.user}),/*#__PURE__*/React.createElement(Flash,{showFlash:this.state.showFlash,flashType:this.state.flashType,flashMessage:this.state.flashMessage}),/*#__PURE__*/React.createElement("div",{className:""},"Votre paiement a bien \xE9t\xE9 effectu\xE9. ",/*#__PURE__*/React.createElement("br",null),"Vous \xEAtes maintenant inscrit au coaching avec ",this.state.reservation.coach_name," pour le ",date," \xE0 ",time,". Vous allez \xEAtre redirig\xE9 vers votre page de coachings."))}}const domContainer=document.querySelector(".page-wrapper");ReactDOM.render(/*#__PURE__*/React.createElement(PaymentSuccess,null),domContainer);