var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}import Navbar from'./components/navbar.js';import{NumberInput,TextInput,Button}from'./components/forms/inputs.js';var UserProfile=function(_React$Component){_inherits(UserProfile,_React$Component);function UserProfile(props){_classCallCheck(this,UserProfile);var _this=_possibleConstructorReturn(this,(UserProfile.__proto__||Object.getPrototypeOf(UserProfile)).call(this,props));_this.state={showFlash:false,flashType:'',flashMessage:'',inviteMail:'',user:{email:'',firstname:'',lastname:'',session_price:'50'},form:{email:'',firstname:'',lastname:'',session_price:'50'}};return _this}_createClass(UserProfile,[{key:'componentDidMount',value:function componentDidMount(){var _this2=this;http.get('/api/me').then(function(res){_this2.setState({user:res.data,form:Object.assign({},res.data,{session_price:'50'})})}).catch(function(err){_this2.showFlashMessage('error','Une erreur inattendue est survenue')})}},{key:'sendForm',value:function sendForm(){var _this3=this;if(this.state.user.role!='coach')delete this.state.form.session_price;http.post('/edit-infos',this.state.form).then(function(res){_this3.showFlashMessage('success','Vos informations ont bien \xE9t\xE9 mises \xE0 jour.')}).catch(function(err){_this3.showFlashMessage('error','Une erreur inattendue est survenue')})}},{key:'sendInviteMail',value:function sendInviteMail(){var _this4=this;if(this.state.inviteMail=='')return;http.post('/signup-invite',{email:this.state.inviteMail}).then(function(res){if(res.status==200){_this4.showFlashMessage('success','L\'invitation a \xE9t\xE9 envoy\xE9e avec succ\xE8s');_this4.setState({inviteMail:''})}else _this4.showFlashMessage('error','Une erreur est survenue lors de l\'envoi.')}).catch(function(err){_this4.showFlashMessage('error',err.response.data||'Une erreur inattendue est survenue.')})}},{key:'showFlashMessage',value:function showFlashMessage(type,message){var _this5=this;this.setState({showFlash:true,flashMessage:message,flashType:type},function(){setTimeout(function(){_this5.setState({showFlash:false})},5000)})}},{key:'render',value:function render(){var _this6=this;return React.createElement('div',null,React.createElement(Navbar,{user:this.state.user}),React.createElement(Flash,{showFlash:this.state.showFlash,flashType:this.state.flashType,flashMessage:this.state.flashMessage}),React.createElement('div',{className:'infos-wrapper'},React.createElement('h1',{className:'page-title'},'Mes informations'),React.createElement('div',{className:'infos-content-wrapper infos-form'},React.createElement(TextInput,{extraClass:'white-bg cl-form-input text-3',required:true,value:this.state.form.lastname,bold_label:true,label:'Nom',onChange:function onChange(e){_this6.setState({form:Object.assign({},_this6.state.form,{lastname:e})})},name:'lastname',placeholder:'Nom'}),React.createElement(TextInput,{extraClass:'white-bg cl-form-input text-3',required:true,value:this.state.form.firstname,bold_label:true,label:'Prenom',onChange:function onChange(e){_this6.setState({form:Object.assign({},_this6.state.form,{firstname:e})})},name:'firstname',placeholder:'Prenom'}),React.createElement(TextInput,{extraClass:'white-bg cl-form-input text-3',required:true,value:this.state.form.email,bold_label:true,label:'Adresse mail',onChange:function onChange(e){_this6.setState({form:Object.assign({},_this6.state.form,{email:e})})},name:'email',placeholder:'Adresse mail'}),React.createElement('div',{className:this.state.user.role!='coach'?'hidden':''},React.createElement(NumberInput,{extraClass:'white-bg cl-form-input text-3',required:false,value:this.state.form.session_price,bold_label:true,label:'Prix d\'une s\xE9ance (\u20AC)',onChange:function onChange(e){_this6.setState({form:Object.assign({},_this6.state.form,{session_price:e})})},name:'session_price',max:500,min:10})),React.createElement('div',{className:'input-group'},React.createElement('div',{className:'button-group mb-2'},React.createElement('button',{onClick:function onClick(){_this6.sendForm()},className:'cl-button'},'Valider'))),React.createElement('div',{className:this.state.user.role=='coach'?'':' hidden'},React.createElement('h2',{className:'page-title mt-2'},'Invitez vos coach\xE9s !'),React.createElement('div',{className:'invite-mail-block'},React.createElement(TextInput,{type:'email',extraClass:'text-3 white-bg',required:true,value:this.state.inviteMail,onChange:function onChange(e){_this6.setState({inviteMail:e})},name:'invite_mail',placeholder:'Email du coach\xE9'}),React.createElement(Button,{extraClass:'text-3',onClick:function onClick(){_this6.sendInviteMail()},text:'Suivant'}))))))}}]);return UserProfile}(React.Component);var domContainer=document.querySelector('.user-profile');ReactDOM.render(React.createElement(UserProfile,null),domContainer);